"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[731],{1731:(D,b,i)=>{i.r(b),i.d(b,{DebtViewModule:()=>j});var u=i(8583),m=i(9805),f=i(2024),Z=i(8966),_=i(3497),w=i(6460),l=i(8109),A=i(8287),c=i(4655),a=i(3679),V=i(4463),x=i(2134),P=i(29),T=i(1558),t=i(7716),O=i(7322),M=i(680),U=i(42);function L(r,d){if(1&r){const e=t.EpF();t.TgZ(0,"form",6),t.TgZ(1,"mat-form-field"),t.TgZ(2,"mat-label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"input",7),t.NdJ("change",function(){return t.CHM(e),t.oxw().dateChange()}),t.qZA(),t.qZA(),t.TgZ(6,"mat-form-field"),t.TgZ(7,"mat-label"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t._UZ(10,"input",8),t.qZA(),t.TgZ(11,"app-button",9),t.NdJ("clickEvent",function(){return t.CHM(e),t.oxw().viewDebtor()}),t.ALo(12,"translate"),t.qZA(),t.qZA()}if(2&r){const e=t.oxw();t.Q6J("formGroup",e.formGroup),t.xp6(2),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(4,13,"fromDate")," "),t.xp6(4),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(9,15,"toDate")," "),t.xp6(3),t.Q6J("text",t.lcZ(12,17,"view"))("disabled",!(e.formGroup.dirty&&e.formGroup.valid))}}function E(r,d){if(1&r&&(t.ynx(0),t.TgZ(1,"div",3),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"div",3),t._uU(5),t.qZA(),t.TgZ(6,"div",2),t._uU(7),t.ALo(8,"number"),t.qZA(),t.TgZ(9,"div",2),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"div",2),t._uU(13),t.ALo(14,"number"),t.qZA(),t.BQk()),2&r){const e=d.$implicit;t.xp6(2),t.Oqu(t.xi3(3,5,e.date,"dd.MM.yyyy")),t.xp6(3),t.Oqu(e.description),t.xp6(2),t.hij(" ",t.Dn7(8,8,e.owed,"1.2-2","de")," "),t.xp6(3),t.hij(" ",t.Dn7(11,12,e.debt,"1.2-2","de")," "),t.xp6(3),t.hij(" ",t.Dn7(14,16,e.state,"1.2-2","de")," ")}}function I(r,d){if(1&r&&(t.TgZ(0,"div",10),t.TgZ(1,"div",11),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",11),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"div",11),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"div",11),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"div",11),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.YNc(16,E,15,20,"ng-container",12),t.TgZ(17,"div",13),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"div",14),t._uU(21),t.ALo(22,"number"),t.qZA(),t.TgZ(23,"div",14),t._uU(24),t.ALo(25,"number"),t.qZA(),t.TgZ(26,"div",14),t._uU(27),t.ALo(28,"number"),t.qZA(),t.qZA()),2&r){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,10,"date")),t.xp6(3),t.Oqu(t.lcZ(6,12,"description")),t.xp6(3),t.Oqu(t.lcZ(9,14,"owed")),t.xp6(3),t.Oqu(t.lcZ(12,16,"debt")),t.xp6(3),t.Oqu(t.lcZ(15,18,"state")),t.xp6(2),t.Q6J("ngForOf",e.debtView.transactions),t.xp6(2),t.hij(" ",t.lcZ(19,20,"turnover"),": "),t.xp6(3),t.hij(" ",t.Dn7(22,22,e.debtView.debtSum,"1.2-2","de")," "),t.xp6(3),t.hij(" ",t.Dn7(25,26,e.debtView.owedSum,"1.2-2","de")," "),t.xp6(3),t.hij(" ",t.Dn7(28,30,e.debtView.debtSum-e.debtView.owedSum,"1.2-2","de")," ")}}const S=[{path:"",component:(()=>{class r{constructor(e,o,s){this.webService=e,this.route=o,this.translateService=s,this.subs=new V.L,this.buyerOID=null,this.isLoading=!0,this.formGroup=new a.cw({fromDate:new a.NI("",[a.kI.required]),toDate:new a.NI("",[a.kI.required])})}ngOnInit(){this.buyerOID=this.route.snapshot.paramMap.get("buyerOID"),this.buyerOID&&(this.subs.sink=this.webService.getDebtor(this.buyerOID).subscribe(e=>{this.entity=e,this.isLoading=!1,this.convertDebtorToTransactions()}))}dateChange(){var e,o,s,g;const p=null===(e=this.formGroup.get("fromDate"))||void 0===e?void 0:e.value,v=null===(o=this.formGroup.get("toDate"))||void 0===o?void 0:o.value;(p&&!v||p&&v&&new Date(v)<new Date(p))&&(null===(s=this.formGroup.get("toDate"))||void 0===s||s.setValue(null===(g=this.formGroup.get("fromDate"))||void 0===g?void 0:g.value))}viewDebtor(){var e,o;this.convertDebtorToTransactions(null===(e=this.formGroup.get("fromDate"))||void 0===e?void 0:e.value,null===(o=this.formGroup.get("toDate"))||void 0===o?void 0:o.value)}convertDebtorToTransactions(e,o){var s,g,p,v,y,C;this.debtView={owedSum:0,debtSum:0,transactions:[]};const h=!!e&&!!o;null===(g=null===(s=this.entity)||void 0===s?void 0:s.invoices)||void 0===g||g.forEach(n=>{(!h||h&&e&&o&&e<=n.dateOfCreate&&n.dateOfCreate<=o)&&(this.debtView.transactions.push({date:n.dateOfCreate,description:this.translateService.instant((0,x.YQ)(n.type))+": "+n.number,owed:n.grossAmount,debt:0,state:0}),this.debtView.debtSum+=n.grossAmount)}),null===(v=null===(p=this.entity)||void 0===p?void 0:p.incomes)||void 0===v||v.forEach(n=>{(!h||h&&e&&o&&e<=n.date&&n.date<=o)&&(this.debtView.transactions.push({date:n.date,description:this.translateService.instant("income")+(n.comment?", "+n.comment:"")+(n.bankStatementNumber?", Izvod: "+n.bankStatementNumber:""),debt:n.amount,owed:0,state:0}),this.debtView.owedSum+=n.amount)}),null===(C=null===(y=this.entity)||void 0===y?void 0:y.outcomes)||void 0===C||C.forEach(n=>{(!h||h&&e&&o&&e<=n.date&&n.date<=o)&&(this.debtView.transactions.push({date:n.date,description:this.translateService.instant("outcome")+", "+n.comment,owed:n.amount,debt:0,state:0}),this.debtView.debtSum+=n.amount)}),this.debtView.transactions=this.debtView.transactions.sort((n,N)=>Number(new Date(n.date))-Number(new Date(N.date)));for(let n=0;n<this.debtView.transactions.length;n++)this.debtView.transactions[n].state=0===n?this.debtView.transactions[n].owed-this.debtView.transactions[n].debt:this.debtView.transactions[n-1].state+this.debtView.transactions[n].owed-this.debtView.transactions[n].debt}ngOnDestroy(){this.subs.unsubscribe()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(T.X),t.Y36(c.gz),t.Y36(m.sK))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-debt-view"]],features:[t._Bn([P.N,T.X])],decls:19,vars:14,consts:[[1,"container"],[1,"title","grid-container","standard-grid-table"],[1,"grid-item","align-right"],[1,"grid-item"],["class","form",3,"formGroup",4,"ngIf"],["class","grid-container standard-grid-table",4,"ngIf"],[1,"form",3,"formGroup"],["type","date","matInput","","formControlName","fromDate",3,"change"],["type","date","matInput","","formControlName","toDate"],[1,"view-button","no-print",3,"text","disabled","clickEvent"],[1,"grid-container","standard-grid-table"],[1,"grid-item","header"],[4,"ngFor","ngForOf"],[1,"grid-item","colspan2","top-border","bold"],[1,"grid-item","align-right","top-border","bold"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3),t._uU(6),t.qZA(),t.TgZ(7,"div",2),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"div",3),t._uU(11),t.qZA(),t.TgZ(12,"div",2),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"div",3),t._uU(16),t.qZA(),t.qZA(),t.YNc(17,L,13,19,"form",4),t.YNc(18,I,29,34,"div",5),t.qZA()),2&e&&(t.xp6(3),t.hij("",t.lcZ(4,8,"company"),":"),t.xp6(3),t.Oqu(null==o.entity||null==o.entity.buyer?null:o.entity.buyer.name),t.xp6(2),t.hij("",t.lcZ(9,10,"address"),":"),t.xp6(3),t.Oqu(null==o.entity||null==o.entity.buyer?null:o.entity.buyer.address),t.xp6(2),t.hij("",t.lcZ(14,12,"pib"),":"),t.xp6(3),t.Oqu(null==o.entity||null==o.entity.buyer?null:o.entity.buyer.pib),t.xp6(1),t.Q6J("ngIf",o.formGroup),t.xp6(1),t.Q6J("ngIf",o.debtView))},directives:[u.O5,a._Y,a.JL,a.sg,O.KE,O.hX,M.Nt,a.Fj,a.JJ,a.u,U.r,u.sg],pipes:[m.X$,u.JJ,u.uU],styles:[".container[_ngcontent-%COMP%]{height:calc(100%)}.container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.1em;font-weight:600}.container[_ngcontent-%COMP%]   .title.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto}.container[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto auto auto;max-height:calc(100% - 100px);overflow-y:auto}.container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .grid-item.colspan2[_ngcontent-%COMP%]{grid-column:1/span 2}.container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .grid-item.colspan3[_ngcontent-%COMP%]{grid-column:1/span 3}.container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .grid-item.top-border[_ngcontent-%COMP%]{border-top:1px solid var(--color-black)}.container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .grid-item.bold[_ngcontent-%COMP%]{font-weight:600}.view-button[_ngcontent-%COMP%]{margin-left:20px}@media print{.no-print[_ngcontent-%COMP%]{display:none!important}}"]}),r})(),data:{permission:"DEBTOR_VIEW"}}];let q=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[c.Bz.forChild(S)],c.Bz]}),r})(),j=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[u.ez,q,m.aw,f.h,Z.Is,_.N,w.n,l.V,A.n,a.UX,M.c,O.lN]]}),r})()},9360:(D,b,i)=>{i.d(b,{K:()=>m});var u=i(8228);class m extends u.g{constructor(){super(...arguments),this.description=""}}},29:(D,b,i)=>{i.d(b,{N:()=>w});var u=i(4292),m=i(136),f=i(9360),Z=i(7716),_=i(7515);let w=(()=>{class l extends u.h{constructor(c){super(c,f.K,m.HT),this.baseWebService=c}}return l.\u0275fac=function(c){return new(c||l)(Z.LFG(_.I))},l.\u0275prov=Z.Yz7({token:l,factory:l.\u0275fac}),l})()}}]);