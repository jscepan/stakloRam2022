"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[618],{9618:(at,H,u)=>{u.r(H),u.d(H,{InvoiceCreateEditModule:()=>st});var x=u(8583),q=u(4655),ae=u(7095),c=u(3679),B=u(1217),R=u(4794),P=u(4463),V=u(7379),le=u(6254),Y=u(7342),N=u(136),C=u(2134),T=u(5595),de=u(287),ue=u(9761),me=u(8002),M=u(2050),I=u(8966),G=u(7574),$=u(6215),z=u(8939),e=u(7716),K=u(4286),X=u(4237),S=u(42),Z=u(7446),y=u(4333);const pe=function(i){return{selected:i}};let _e=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-work-order-selection-item"]],inputs:{dataModel:"dataModel"},features:[e._Bn([])],decls:31,vars:27,consts:[[1,"item-card",3,"ngClass"],[1,"container"],[1,"number"],[1,"date"],[1,"bold"],[1,"for-person"],[1,"value"],[1,"note"],[1,"description"],[1,"checkbox"],["name","Primary","color","primary",3,"checked"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.qZA(),e.TgZ(6,"div",3),e.TgZ(7,"span",4),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"div",6),e.TgZ(14,"span",4),e._uU(15),e.ALo(16,"translate"),e.qZA(),e._uU(17),e.qZA(),e.qZA(),e.TgZ(18,"div",7),e.TgZ(19,"div",6),e.TgZ(20,"span",4),e._uU(21),e.ALo(22,"translate"),e.qZA(),e._uU(23),e.qZA(),e.qZA(),e.TgZ(24,"div",8),e.TgZ(25,"span",4),e._uU(26),e.ALo(27,"translate"),e.qZA(),e._uU(28),e.qZA(),e.qZA(),e.TgZ(29,"div",9),e._UZ(30,"mat-checkbox",10),e.qZA(),e.qZA()),2&t&&(e.Q6J("ngClass",e.VKq(25,pe,o.dataModel.selected)),e.xp6(4),e.AsE("",e.lcZ(5,12,"nr"),": ",o.dataModel.number,""),e.xp6(4),e.Oqu(e.lcZ(9,14,"date")),e.xp6(2),e.hij(": ",e.xi3(11,16,o.dataModel.date,"dd.MM.yyyy")," "),e.xp6(5),e.Oqu(e.lcZ(16,19,"forPerson")),e.xp6(2),e.hij(": ",o.dataModel.forPerson," "),e.xp6(4),e.Oqu(e.lcZ(22,21,"note")),e.xp6(2),e.hij(": ",o.dataModel.note," "),e.xp6(3),e.Oqu(e.lcZ(27,23,"description")),e.xp6(2),e.hij(": ",o.dataModel.description," "),e.xp6(2),e.Q6J("checked",o.dataModel.selected||!1))},directives:[x.mk,Z.oG],pipes:[y.X$,x.uU],styles:[".item-card[_ngcontent-%COMP%]{display:flex;cursor:pointer;transition:transform .5s ease;width:200px;height:200px;background-color:var(--color-white);position:relative;box-shadow:0 4px 4px #0000001a;border-radius:6px;border:1px solid var(--color-main-light, #bbbbbb);width:150px;height:150px;margin:10px}.item-card[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:absolute;width:100%;display:flex;flex-direction:column;margin-top:5px;width:150px;height:140px}.item-card[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{font-weight:600;margin:5px 0;text-align:center}.item-card[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{flex-grow:1;overflow:hidden;width:100%;height:100%}.item-card[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;position:absolute;z-index:1;margin-top:10px;margin-left:130px}.item-card.selected[_ngcontent-%COMP%]{opacity:.7}.item-card[_ngcontent-%COMP%]:hover{transform:scale(1.15)}.value[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.bold[_ngcontent-%COMP%]{font-weight:600}"]}),i})();function ve(i,l){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-work-order-selection-item",4),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().handleItemClick(r.item)}),e.qZA(),e.BQk()}if(2&i){const t=l.$implicit;e.xp6(1),e.Q6J("dataModel",t.item)}}let ge=(()=>{class i{constructor(t,o,n,r,s){this.dialogRef=t,this.data=o,this.cdRef=n,this.webService=r,this.listEntities=s,this.subs=new P.L,this.buyerOID="",this.invoiceType="",this.excludedOids=[],this.isSingleSelection=!0,this.isLoading$=new $.X(!1),this.isLoading=this.isLoading$.asObservable(),this.selection=[],this.items=[],this.buyerOID=o.buyerOID,this.excludedOids=(null==o?void 0:o.excludedOids)||[],this.isSingleSelection=!1!==o.isSingleSelection}ngOnInit(){this.isLoading$.next(!0),this.subs.sink=this.webService.getAllUnsettledWorkOrderForBuyer(this.buyerOID).pipe((0,z.x)(()=>{this.isLoading$.next(!1)})).subscribe(t=>{this.items=t.map(o=>({item:{oid:o.oid,date:o.dateOfCreate,number:(0,C.Nw)(o),forPerson:o.forPerson,note:o.note,description:o.description},object:o}))})}ngAfterViewInit(){this.cdRef.detectChanges()}handleItemClick(t){this.items=this.items.map(o=>this.isSingleSelection?Object.assign(Object.assign({},o),{item:Object.assign(Object.assign({},o.item),{selected:o.item.oid===t.oid})}):o.item.oid===t.oid?Object.assign(Object.assign({},o),{item:Object.assign(Object.assign({},o.item),{selected:!o.item.selected})}):Object.assign({},o)),this.updateSelection()}updateSelection(){this.selection=[],this.items.forEach(t=>{t.item.selected&&this.selection.push(t.item.oid)})}saveSelection(){const t=[];this.items.forEach(o=>{o.item.selected&&t.push(o.object)}),this.dialogRef.close(t)}cancelSaveSelection(){this.dialogRef.close()}bottomReachedHandler(){this.listEntities.requestNextPage()}ngOnDestroy(){this.subs.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.so),e.Y36(I.WI),e.Y36(e.sBO),e.Y36(M.o),e.Y36(T.y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-work-order-selection-popup"]],features:[e._Bn([T.y,M.o])],decls:8,vars:11,consts:[["scrollToBottom","",3,"componentLoading","bottomReached"],[4,"ngFor","ngForOf"],["color","secondary",3,"text","clickEvent"],["color","primary",3,"text","disabled","clickEvent"],[1,"item",3,"dataModel","click"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-dialog-content",0),e.NdJ("bottomReached",function(){return o.bottomReachedHandler()}),e.ALo(1,"async"),e.YNc(2,ve,2,1,"ng-container",1),e.qZA(),e.TgZ(3,"mat-dialog-actions"),e.TgZ(4,"app-button",2),e.NdJ("clickEvent",function(){return o.cancelSaveSelection()}),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"app-button",3),e.NdJ("clickEvent",function(){return o.saveSelection()}),e.ALo(7,"translate"),e.qZA(),e.qZA()),2&t&&(e.Q6J("componentLoading",e.lcZ(1,5,o.isLoading)||!1),e.xp6(2),e.Q6J("ngForOf",o.items),e.xp6(2),e.Q6J("text",e.lcZ(5,7,"cancel")),e.xp6(2),e.Q6J("text",e.lcZ(7,9,"import"))("disabled",!o.selection.length))},directives:[I.xY,K.C,X.T,x.sg,I.H8,S.r,_e],pipes:[x.Ov,y.X$],styles:["mat-dialog-content[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid var(--attributes-border-color, #efeff3);display:flex;flex-wrap:wrap;height:calc(100% - 70px);max-height:100%}mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.spacer[_ngcontent-%COMP%]{height:0;flex:1 1}"]}),i})(),ee=(()=>{class i{constructor(t){this._matDialog=t,this.subs=new P.L}openDialog(t,o=[],n=!1){return new G.y(r=>{const s=new I.vA;s.width="80%",s.height="80%",s.data={buyerOID:t,excludedOids:o,isSingleSelection:n},this.subs.sink.$openSelectPopup=this._matDialog.open(ge,s).afterClosed().subscribe(a=>{r.next(a),r.complete()},()=>r.error())})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(I.uw))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var fe=u(5411);function he(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"i-feather",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit;return e.oxw().toggleExpandWorkOrder(n.object.oid)}),e.qZA()}2&i&&e.Q6J("name","plus")}function xe(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"i-feather",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit;return e.oxw().toggleExpandWorkOrder(n.object.oid)}),e.qZA()}2&i&&e.Q6J("name","minus")}function Ce(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"mat-checkbox",16),e.NdJ("change",function(n){e.CHM(t);const r=e.oxw(2).$implicit;return e.oxw().toggleSelectAll(n,r)}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw();e.Q6J("checked",o.isAllChecked(t)),e.xp6(1),e.Oqu(e.lcZ(2,2,"selectDeselectAll"))}}function Ie(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"mat-checkbox",17),e.NdJ("ngModelChange",function(n){return e.CHM(t).$implicit.selected=n})("change",function(){return e.CHM(t),e.oxw(3).updateSelection()}),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()}if(2&i){const t=l.$implicit,o=e.oxw(3);e.Q6J("ngModel",t.selected),e.xp6(1),e.HOy(" ",t.object.description," ",e.lcZ(2,5,"pieces"),": ",t.object.sumQuantity," ",e.lcZ(3,7,o.getUOMDisplayValue(t.object.uom))," ")}}function Oe(i,l){if(1&i&&(e.TgZ(0,"div",12),e.TgZ(1,"div",13),e.YNc(2,Ce,3,4,"mat-checkbox",14),e.YNc(3,Ie,4,9,"mat-checkbox",15),e.qZA(),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngIf",t.workOrderItems.length>1),e.xp6(1),e.Q6J("ngForOf",t.workOrderItems)}}function Ae(i,l){if(1&i&&(e.TgZ(0,"div",5),e.TgZ(1,"div",6),e.TgZ(2,"div",7),e.YNc(3,he,1,1,"i-feather",8),e.YNc(4,xe,1,1,"i-feather",8),e.qZA(),e.TgZ(5,"div",9),e._uU(6),e.ALo(7,"translate"),e.ALo(8,"translate"),e.ALo(9,"translate"),e.ALo(10,"date"),e.qZA(),e.qZA(),e.YNc(11,Oe,4,2,"div",10),e.qZA()),2&i){const t=l.$implicit;e.xp6(3),e.Q6J("ngIf",!t.isExpanded),e.xp6(1),e.Q6J("ngIf",t.isExpanded),e.xp6(2),e.hij(" ",e.lcZ(7,4,"workOrder")+" "+e.lcZ(8,6,"nr")+" "+t.object.number+", "+e.lcZ(9,8,"date")+": "+e.xi3(10,10,t.object.dateOfCreate,"dd.MM.yyyy")," "),e.xp6(5),e.Q6J("ngIf",t.isExpanded)}}let ye=(()=>{class i{constructor(t,o,n,r,s){this.dialogRef=t,this.data=o,this.cdRef=n,this.webService=r,this.listEntities=s,this.subs=new P.L,this.buyerOID="",this.invoiceType="",this.excludedOids=[],this.uomOptions=N.pM,this.getUOMDisplayValue=C.HL,this.isLoading$=new $.X(!1),this.isLoading=this.isLoading$.asObservable(),this.selection=[],this.items=[],this.buyerOID=o.buyerOID,this.excludedOids=(null==o?void 0:o.excludedOids)||[]}ngOnInit(){this.isLoading$.next(!0),this.subs.sink=this.webService.getAllUnsettledWorkOrderForBuyer(this.buyerOID).pipe((0,z.x)(()=>{this.isLoading$.next(!1)})).subscribe(t=>{this.items=t.map(o=>({oid:o.oid,isExpanded:!1,object:o,workOrderItems:o.workOrderItems.filter(n=>!this.excludedOids.includes(n.oid)).map(n=>({selected:!1,object:n}))}))})}ngAfterViewInit(){this.cdRef.detectChanges()}toggleExpandWorkOrder(t){const o=this.items.findIndex(n=>n.object.oid===t);this.items[o].isExpanded&&(this.items[o].workOrderItems=this.items[o].workOrderItems.map(n=>Object.assign(Object.assign({},n),{selected:!1}))),this.items[o].isExpanded=!this.items[o].isExpanded,this.updateSelection()}updateSelection(){this.selection=[],this.items.forEach(t=>{t.workOrderItems.forEach(o=>{o.selected&&this.selection.push(o.object.oid)})})}saveSelection(){const t=[];this.items.forEach(o=>{let n;o.workOrderItems.forEach(r=>{r.selected&&(n||(n=Object.assign(Object.assign({},o.object),{workOrderItems:[]})),n.workOrderItems.push(r.object))}),n&&t.push(n)}),this.dialogRef.close(t)}cancelSaveSelection(){this.dialogRef.close()}bottomReachedHandler(){this.listEntities.requestNextPage()}toggleSelectAll(t,o){o.workOrderItems.forEach(t.checked?n=>n.selected=!0:n=>n.selected=!1),this.updateSelection()}isAllChecked(t){return t.workOrderItems.filter(o=>!0===o.selected).length===t.workOrderItems.length}ngOnDestroy(){this.subs.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.so),e.Y36(I.WI),e.Y36(e.sBO),e.Y36(M.o),e.Y36(T.y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-work-order-item-selection-popup"]],features:[e._Bn([T.y,M.o])],decls:9,vars:11,consts:[["scrollToBottom","",3,"componentLoading","bottomReached"],[1,"content"],["class","item",4,"ngFor","ngForOf"],["color","secondary",3,"text","clickEvent"],["color","primary",3,"text","disabled","clickEvent"],[1,"item"],[1,"title"],[1,"icon"],[3,"name","click",4,"ngIf"],[1,"description"],["class","childrens",4,"ngIf"],[3,"name","click"],[1,"childrens"],[1,"child"],["color","primary",3,"checked","change",4,"ngIf"],["color","primary",3,"ngModel","ngModelChange","change",4,"ngFor","ngForOf"],["color","primary",3,"checked","change"],["color","primary",3,"ngModel","ngModelChange","change"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-dialog-content",0),e.NdJ("bottomReached",function(){return o.bottomReachedHandler()}),e.ALo(1,"async"),e.TgZ(2,"div",1),e.YNc(3,Ae,12,13,"div",2),e.qZA(),e.qZA(),e.TgZ(4,"mat-dialog-actions"),e.TgZ(5,"app-button",3),e.NdJ("clickEvent",function(){return o.cancelSaveSelection()}),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"app-button",4),e.NdJ("clickEvent",function(){return o.saveSelection()}),e.ALo(8,"translate"),e.qZA(),e.qZA()),2&t&&(e.Q6J("componentLoading",e.lcZ(1,5,o.isLoading)||!1),e.xp6(3),e.Q6J("ngForOf",o.items),e.xp6(2),e.Q6J("text",e.lcZ(6,7,"cancel")),e.xp6(2),e.Q6J("text",e.lcZ(8,9,"import"))("disabled",!o.selection.length))},directives:[I.xY,K.C,X.T,x.sg,I.H8,S.r,x.O5,fe.uy,Z.oG,c.JJ,c.On],pipes:[x.Ov,y.X$,x.uU],styles:["mat-dialog-content[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid var(--attributes-border-color, #efeff3);display:flex;flex-wrap:wrap;height:calc(100% - 70px);max-height:100%}mat-dialog-content[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto;flex-grow:1}mat-dialog-content[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-bottom:1px dotted var(--color-main)}mat-dialog-content[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center}mat-dialog-content[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;color:var(--color-info)}mat-dialog-content[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{display:flex}mat-dialog-content[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .childrens[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:40px}mat-dialog-content[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .childrens[_ngcontent-%COMP%]   .child[_ngcontent-%COMP%]{display:flex;flex-direction:column}mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.spacer[_ngcontent-%COMP%]{height:0;flex:1 1}"]}),i})(),te=(()=>{class i{constructor(t){this._matDialog=t,this.subs=new P.L}openDialog(t,o=[]){return new G.y(n=>{const r=new I.vA;r.width="80%",r.height="80%",r.data={buyerOID:t,excludedOids:o},this.subs.sink.$openSelectPopup=this._matDialog.open(ye,r).afterClosed().subscribe(s=>{n.next(s),n.complete()},()=>n.error())})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(I.uw))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var Ze=u(8794),be=u(7347),ke=u(8933),w=u(7322),E=u(4107),oe=u(3722),ne=u(6591),Te=u(1862),ie=u(4657),Me=u(3336),F=u(1079);function Pe(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.AsE(" - ",e.lcZ(2,2,"madeFromPreinvoiceNr"),": ",t.preInvoice.number,"")}}function we(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.AsE(" - ",e.lcZ(2,2,"madeFromAdvanceinvoiceNr"),": ",t.advanceInvoice.number,"")}}function qe(i,l){if(1&i&&(e.TgZ(0,"mat-option",35),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const t=l.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.displayName)," ")}}function Ee(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"input",36),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw(2).onKeypress(n,"numberOfCashBill")}),e.qZA(),e.qZA()}2&i&&(e.xp6(1),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(3,5,"numberOfCashBill")," "))}function Ne(i,l){if(1&i&&(e.TgZ(0,"mat-option",35),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.Q6J("value",t.selectedBuyer),e.xp6(1),e.Oqu(t.selectedBuyer.name)}}function Se(i,l){if(1&i&&(e.TgZ(0,"mat-option",35),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}function Fe(i,l){if(1&i&&(e.ynx(0),e.YNc(1,Se,2,2,"mat-option",15),e.BQk()),2&i){const t=l.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==o.selectedBuyer?null:o.selectedBuyer.oid)!==t.oid)}}function Je(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"app-button",37),e.NdJ("clickEvent",function(){return e.CHM(t),e.oxw(2).createBuyer()}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("iconName","plus")("disabled",!t.hasPrivilege("BUYER_CREATE"))}}function Le(i,l){if(1&i&&(e.TgZ(0,"mat-option",35),e._uU(1),e.qZA()),2&i){const t=l.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function je(i,l){if(1&i&&(e.TgZ(0,"mat-option",35),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const t=l.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.displayName)," ")}}function Ue(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"mat-option",58),e.NdJ("click",function(){const r=e.CHM(t).index,s=e.oxw(2).index;return e.oxw(3).removeWorkOrderItemFromInvoiceItem(s,r)}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&i){const t=l.$implicit,o=e.oxw(5);e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.value.description+", "+t.value.sumQuantity+" "+e.lcZ(2,2,o.getUOMDisplayValue(t.value.uom)))}}function We(i,l){if(1&i&&(e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-select",56),e.YNc(5,Ue,3,4,"mat-option",57),e.qZA(),e.qZA()),2&i){const t=e.oxw(),o=t.$implicit,n=t.index,r=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,3,"workOrder")),e.xp6(2),e.Q6J("value",o.value.workOrderItems),e.xp6(1),e.Q6J("ngForOf",r.getWorkOrderItemsFormArr(n).controls)}}function Qe(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",40),e.TgZ(1,"div",41),e.TgZ(2,"mat-form-field",42),e.TgZ(3,"mat-label"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"input",43,44),e.NdJ("keydown.enter",function(){return e.CHM(t),e.MAs(7).closePanel()})("keypress",function(n){const s=e.CHM(t).index;return e.oxw(3).onKeypress(n,"description",s)}),e.qZA(),e.TgZ(8,"mat-autocomplete",null,45),e.YNc(10,Le,2,2,"mat-option",9),e.ALo(11,"async"),e.qZA(),e.qZA(),e.TgZ(12,"mat-form-field",46),e.TgZ(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"mat-select",47),e.NdJ("openedChange",function(n){const s=e.CHM(t).index;return e.oxw(3).openedToggleOnUomSelect(n,s)}),e.YNc(17,je,3,4,"mat-option",9),e.qZA(),e.qZA(),e.TgZ(18,"mat-form-field",46),e.TgZ(19,"mat-label"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"input",48),e.NdJ("keypress",function(n){const s=e.CHM(t).index;return e.oxw(3).onKeypress(n,"quantity",s)})("change",function(){const r=e.CHM(t).index;return e.oxw(3).calculateInvoiceItemAmount(r,"quantity")})("focusout",function(){e.CHM(t);const n=e.oxw(3);return n.calculateInvoiceAmount(),n.setAllInvoiceAmounts()}),e.qZA(),e.qZA(),e.TgZ(23,"mat-form-field",46),e.TgZ(24,"mat-label"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"input",49),e.NdJ("keypress",function(n){const s=e.CHM(t).index;return e.oxw(3).onKeypress(n,"pricePerUnit",s)})("change",function(){const r=e.CHM(t).index;return e.oxw(3).calculateInvoiceItemAmount(r,"pricePerUnit")})("focusout",function(){e.CHM(t);const n=e.oxw(3);return n.calculateInvoiceAmount(),n.setAllInvoiceAmounts()}),e.qZA(),e.qZA(),e.TgZ(28,"mat-form-field",46),e.TgZ(29,"mat-label"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"input",50),e.NdJ("keypress",function(n){const s=e.CHM(t).index;return e.oxw(3).onKeypress(n,"netPrice",s)})("change",function(){const r=e.CHM(t).index;return e.oxw(3).calculateInvoiceItemAmount(r,"netPrice")})("focusout",function(){e.CHM(t);const n=e.oxw(3);return n.calculateInvoiceAmount(),n.setAllInvoiceAmounts()}),e.qZA(),e.qZA(),e.TgZ(33,"mat-form-field",46),e.TgZ(34,"mat-label"),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"input",51),e.NdJ("keypress",function(n){const s=e.CHM(t).index;return e.oxw(3).onKeypress(n,"vatRate",s)})("change",function(){const r=e.CHM(t).index;return e.oxw(3).calculateInvoiceItemAmount(r,"vatRate")})("focusout",function(){e.CHM(t);const n=e.oxw(3);return n.calculateInvoiceAmount(),n.setAllInvoiceAmounts()}),e.qZA(),e.qZA(),e.TgZ(38,"mat-form-field",46),e.TgZ(39,"mat-label"),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"input",52),e.NdJ("keypress",function(n){const s=e.CHM(t).index;return e.oxw(3).onKeypress(n,"vatAmount",s)})("change",function(){const r=e.CHM(t).index;return e.oxw(3).calculateInvoiceItemAmount(r,"vatAmount")})("focusout",function(){e.CHM(t);const n=e.oxw(3);return n.calculateInvoiceAmount(),n.setAllInvoiceAmounts()}),e.qZA(),e.qZA(),e.TgZ(43,"mat-form-field",46),e.TgZ(44,"mat-label"),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"input",53),e.NdJ("keypress",function(n){const s=e.CHM(t).index;return e.oxw(3).onKeypress(n,"grossPrice",s)})("change",function(){const r=e.CHM(t).index;return e.oxw(3).calculateInvoiceItemAmount(r,"grossPrice")})("focusout",function(){e.CHM(t);const n=e.oxw(3);return n.calculateInvoiceAmount(),n.setAllInvoiceAmounts()}),e.qZA(),e.qZA(),e.YNc(48,We,6,5,"mat-form-field",3),e.TgZ(49,"app-button",54),e.NdJ("clickEvent",function(){const r=e.CHM(t).index;return e.oxw(3).importWorkOrderItems(r)}),e.ALo(50,"translate"),e.qZA(),e.TgZ(51,"app-button",55),e.NdJ("clickEvent",function(){const r=e.CHM(t).index;return e.oxw(3).removeItem(r)}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=l.$implicit,o=l.index,n=e.MAs(9),r=e.oxw(3);e.xp6(1),e.Q6J("formGroupName",o),e.xp6(2),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(5,48,"description")," "),e.xp6(2),e.Q6J("matAutocomplete",n),e.xp6(4),e.Q6J("ngForOf",e.lcZ(11,50,r.getFilteredOptions(o))),e.xp6(3),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(15,52,"uom")," "),e.xp6(3),e.Q6J("ngForOf",r.uomOptions),e.xp6(2),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(21,54,"quantity")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(26,56,"pricePerUnit")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(31,58,"netPrice")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(36,60,"vatRate")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(41,62,"vatAmount")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(46,64,"grossPrice")," "),e.xp6(3),e.Q6J("ngIf",t.value.workOrderItems.length>0),e.xp6(1),e.Q6J("text",e.lcZ(50,66,"import")),e.xp6(2),e.Q6J("iconName","minus")("isTransparentMode",!0)}}function De(i,l){if(1&i&&(e.TgZ(0,"div",38),e.YNc(1,Qe,52,68,"div",39),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.invoiceItemsFormArr.controls)}}function He(i,l){1&i&&(e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"input",59),e.qZA()),2&i&&(e.xp6(1),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(3,5,"advancePayAmount")," "))}function Be(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",7),e.TgZ(1,"div",41),e.TgZ(2,"mat-form-field"),e.TgZ(3,"mat-label"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"input",63),e.qZA(),e.TgZ(7,"mat-form-field"),e.TgZ(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"input",64),e.qZA(),e.qZA(),e.TgZ(12,"app-button",55),e.NdJ("clickEvent",function(){const r=e.CHM(t).index;return e.oxw(3).removeNote(r)}),e.qZA(),e.qZA()}if(2&i){const t=l.index;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(3),e.Oqu(e.lcZ(5,5,"field")),e.xp6(5),e.Oqu(e.lcZ(10,7,"value")),e.xp6(3),e.Q6J("iconName","minus")("isTransparentMode",!0)}}function Re(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",60),e.YNc(1,Be,13,9,"div",61),e.TgZ(2,"app-button",62),e.NdJ("clickEvent",function(){return e.CHM(t),e.oxw(2).addNote()}),e.ALo(3,"translate"),e.qZA(),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.notesFormArr.controls),e.xp6(1),e.Q6J("text",e.lcZ(3,2,"addNote"))}}const Ve=function(){return{standalone:!0}};function Ye(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"form",6),e.TgZ(1,"div",7),e.TgZ(2,"mat-form-field"),e.TgZ(3,"mat-label"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"mat-select",8),e.NdJ("valueChange",function(n){return e.CHM(t),e.oxw().invoiceTypeChanged(n)}),e.YNc(7,qe,3,4,"mat-option",9),e.qZA(),e.qZA(),e.YNc(8,Ee,5,7,"mat-form-field",3),e.TgZ(9,"mat-form-field"),e.TgZ(10,"mat-label"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"input",10),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"currency")}),e.qZA(),e.qZA(),e.TgZ(14,"mat-form-field"),e.TgZ(15,"mat-label"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"input",11),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"number")}),e.qZA(),e.qZA(),e.TgZ(19,"app-button",12),e.NdJ("clickEvent",function(){return e.CHM(t),e.oxw().setInvoiceNumber()}),e.ALo(20,"translate"),e.qZA(),e.qZA(),e.TgZ(21,"div",7),e.TgZ(22,"mat-form-field"),e.TgZ(23,"mat-label"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"mat-select",13),e.NdJ("valueChange",function(){return e.CHM(t),e.oxw().buyerChanged()})("infiniteScroll",function(){return e.CHM(t),e.oxw().bottomReachedHandlerBuyers()})("selectionChange",function(n){return e.CHM(t),e.oxw().selectBuyer(n)}),e.TgZ(27,"mat-option"),e.TgZ(28,"ngx-mat-select-search",14),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().searchHandler(n)}),e.ALo(29,"translate"),e.ALo(30,"translate"),e.ALo(31,"async"),e.qZA(),e.qZA(),e.YNc(32,Ne,2,2,"mat-option",15),e.YNc(33,Fe,2,1,"ng-container",16),e.ALo(34,"async"),e.qZA(),e.qZA(),e.YNc(35,Je,1,2,"app-button",17),e.TgZ(36,"mat-checkbox",18),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().isInvoiceTaxFree=n})("change",function(){return e.CHM(t),e.oxw().changeIsInvoiceTaxFree()}),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.qZA(),e.TgZ(39,"div",7),e.TgZ(40,"mat-form-field"),e.TgZ(41,"mat-label"),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"input",19),e.NdJ("change",function(){return e.CHM(t),e.oxw().consolidateAllDates()})("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"dateOfCreate")}),e.qZA(),e.qZA(),e.TgZ(45,"mat-form-field"),e.TgZ(46,"mat-label"),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"input",20),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"dateOfTurnover")}),e.qZA(),e.qZA(),e.TgZ(50,"mat-form-field"),e.TgZ(51,"mat-label"),e._uU(52),e.ALo(53,"translate"),e.qZA(),e.TgZ(54,"input",21),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"dateOfMaturity")}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(55,"div",7),e.TgZ(56,"mat-form-field"),e.TgZ(57,"mat-label"),e._uU(58),e.ALo(59,"translate"),e.qZA(),e.TgZ(60,"input",22),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"country")}),e.qZA(),e.qZA(),e.TgZ(61,"mat-form-field"),e.TgZ(62,"mat-label"),e._uU(63),e.ALo(64,"translate"),e.qZA(),e.TgZ(65,"input",23),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"placeOfIssue")}),e.qZA(),e.qZA(),e.TgZ(66,"mat-form-field"),e.TgZ(67,"mat-label"),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"input",24),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"methodOfPayment")}),e.qZA(),e.qZA(),e.qZA(),e.YNc(71,De,2,1,"div",25),e.TgZ(72,"div",26),e.TgZ(73,"app-button",27),e.NdJ("clickEvent",function(){return e.CHM(t),e.oxw().addNewItem()}),e.ALo(74,"translate"),e.qZA(),e.TgZ(75,"app-button",28),e.NdJ("clickEvent",function(){return e.CHM(t),e.oxw().autoImport()}),e.ALo(76,"translate"),e.qZA(),e.qZA(),e.TgZ(77,"mat-form-field"),e.TgZ(78,"mat-label"),e._uU(79),e.ALo(80,"translate"),e.qZA(),e.TgZ(81,"textarea",29),e.NdJ("keypress",function(n){return e.CHM(t),e.oxw().onKeypress(n,"comment")}),e.qZA(),e.qZA(),e.TgZ(82,"div",7),e.TgZ(83,"mat-form-field"),e.TgZ(84,"mat-label"),e._uU(85),e.ALo(86,"translate"),e.qZA(),e._UZ(87,"input",30),e.qZA(),e.TgZ(88,"mat-form-field"),e.TgZ(89,"mat-label"),e._uU(90),e.ALo(91,"translate"),e.qZA(),e._UZ(92,"input",31),e.qZA(),e.TgZ(93,"mat-form-field"),e.TgZ(94,"mat-label"),e._uU(95),e.ALo(96,"translate"),e.qZA(),e._UZ(97,"input",32),e.qZA(),e.TgZ(98,"mat-form-field"),e.TgZ(99,"mat-label"),e._uU(100),e.ALo(101,"translate"),e.qZA(),e._UZ(102,"input",33),e.qZA(),e.YNc(103,He,5,7,"mat-form-field",3),e.qZA(),e.YNc(104,Re,4,4,"div",34),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("formGroup",t.formGroup),e.xp6(3),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(5,111,"type")," "),e.xp6(2),e.Q6J("disabled",t.isEdit),e.xp6(1),e.Q6J("ngForOf",t.typesOptions),e.xp6(1),e.Q6J("ngIf",t.numberOfCashBillControl),e.xp6(2),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(12,113,"currency")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(17,115,"number")," "),e.xp6(3),e.Q6J("isTransparentMode",!0)("text",e.lcZ(20,117,"createNumber")),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(25,119,"buyer")," "),e.xp6(2),e.Q6J("disabled",t.isEdit)("compareWith",t.compareFn),e.xp6(2),e.s9C("placeholderLabel",e.lcZ(29,121,"searchFor")),e.s9C("noEntriesFoundLabel",e.lcZ(30,123,"noResults")),e.Q6J("formControl",t.searchControl)("hideClearSearchButton",!0)("clearSearchInput",!0)("searching",e.lcZ(31,125,t.isLoading)||!1)("disableScrollToActiveOnOptionsChanged",!0),e.xp6(4),e.Q6J("ngIf",t.selectedBuyer),e.xp6(1),e.Q6J("ngForOf",e.lcZ(34,127,t.buyersEntities)),e.xp6(2),e.Q6J("ngIf",!t.isEdit),e.xp6(1),e.Q6J("color","primary")("ngModel",t.isInvoiceTaxFree)("ngModelOptions",e.DdM(157,Ve)),e.xp6(1),e.Oqu(e.lcZ(38,129,"invoiceTaxFree")),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(43,131,"dateOfCreate")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(48,133,"dateOfTurnover")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(53,135,"dateOfMaturity")," "),e.xp6(5),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(59,137,"country")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(64,139,"placeOfIssue")," "),e.xp6(4),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(69,141,"methodOfPayment")," "),e.xp6(3),e.Q6J("ngIf",t.isBuyerSelected),e.xp6(2),e.Q6J("iconName","plus")("text",e.lcZ(74,143,"addNewItem"))("disabled",!t.isBuyerSelected),e.xp6(2),e.Q6J("iconName","plus")("text",e.lcZ(76,145,"autoImport"))("isTransparentMode",!0)("disabled",!t.isBuyerSelected),e.xp6(3),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(80,147,"comment")," "),e.xp6(5),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(86,149,"netAmount")," "),e.xp6(2),e.Q6J("readonly",!0),e.xp6(2),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(91,151,"vatRate")," "),e.xp6(2),e.Q6J("readonly",!0),e.xp6(2),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(96,153,"vatAmount")," "),e.xp6(2),e.Q6J("readonly",!0),e.xp6(2),e.ekj("mark-required",!0)("mark-opt-required",!0),e.xp6(1),e.hij(" ",e.lcZ(101,155,"grossAmount")," "),e.xp6(2),e.Q6J("readonly",!0),e.xp6(1),e.Q6J("ngIf",t.advanceInvoice||t.invoice&&t.invoice.advancePayAmount>0),e.xp6(1),e.Q6J("ngIf",t.notesFormArr.controls)}}function Ge(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",65),e.TgZ(1,"app-button",66),e.NdJ("clickEvent",function(){return e.CHM(t),e.oxw().cancel()}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"app-button",67),e.NdJ("clickEvent",function(){return e.CHM(t),e.oxw().handleSubmitButton()}),e.ALo(4,"translate"),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("text",e.lcZ(2,3,"cancel")),e.xp6(2),e.Q6J("text",e.lcZ(4,5,"save"))("disabled",!t.formGroup.dirty||t.formGroup.invalid)}}const $e=[{path:"",component:(()=>{class i{constructor(t,o,n,r,s,a,m,d,p,f,_,g,v,h){this.router=t,this.route=o,this.globalService=n,this.webService=r,this.workOrderWebService=s,this.buyerWebService=a,this.buyerCreateEditPopupService=m,this.settingsStoreService=d,this.translateService=p,this.listEntities=f,this.el=_,this.workOrderSelectionComponentService=g,this.workOrderItemSelectionComponentService=v,this.authStoreService=h,this.subs=new P.L,this.invoiceOID=null,this.isEdit=!1,this.typesOptions=N.TY,this.uomOptions=N.pM,this.invoiceItemsOptions=[],this.filteredOptions=[],this.buyersEntities=this.listEntities.entities,this.isLoading=this.listEntities.isLoading,this.searchControl=new c.NI,this.compareFn=C.nt,this.isInvoiceTaxFree=!1,this.getUOMDisplayValue=C.HL}get numberOfCashBillControl(){return this.formGroup.get("numberOfCashBill")}getDescription(t){return this.invoiceItemsFormArr.controls[t].get("description")}getUOM(t){return this.invoiceItemsFormArr.controls[t].get("uom")}getQuantity(t){return this.invoiceItemsFormArr.controls[t].get("quantity")}getPricePerUnit(t){return this.invoiceItemsFormArr.controls[t].get("pricePerUnit")}getNetPrice(t){return this.invoiceItemsFormArr.controls[t].get("netPrice")}getVatRate(t){return this.invoiceItemsFormArr.controls[t].get("vatRate")}getVatAmount(t){return this.invoiceItemsFormArr.controls[t].get("vatAmount")}getGrossPrice(t){return this.invoiceItemsFormArr.controls[t].get("grossPrice")}getWorkOrderItemsFormArr(t){return this.invoiceItemsFormArr.controls[t].get("workOrderItems")}get invoiceItemsFormArr(){return this.formGroup.get("invoiceItems")}get notesFormArr(){return this.formGroup.get("notes")}ngOnInit(){this.invoiceOID=this.route.snapshot.paramMap.get("invoiceOID");const t=this.route.snapshot.queryParamMap.get("workOrderOID"),o=this.route.snapshot.queryParamMap.get("preInvoiceOID"),n=this.route.snapshot.queryParamMap.get("advanceInvoiceOID");this.subs.sink=this.webService.getAllInvoiceItemDescriptions().subscribe(r=>{this.invoiceItemsOptions=r}),this.subs.sink=this.listEntities.setWebService(this.buyerWebService).requestFirstPage(),this.subs.sink=this.settingsStoreService.dataLoaded$.subscribe(r=>{r&&(this.settings=this.settingsStoreService.getSettings(),this.isEdit=!!this.invoiceOID,this.isEdit&&this.invoiceOID?this.subs.sink=this.webService.getEntityByOid(this.invoiceOID).subscribe(s=>{this.invoice=s,this.invoice.preInvoiceOid&&(this.subs.sink=this.webService.getEntityByOid(this.invoice.preInvoiceOid).subscribe(a=>{this.preInvoice=a})),this.invoice.advanceInvoiceOid&&(this.subs.sink=this.webService.getEntityByOid(this.invoice.advanceInvoiceOid).subscribe(a=>{this.preInvoice=a})),this.initializeCreate()}):(this.initializeCreate(),t?this.workOrderWebService.getEntityByOid(t).subscribe(s=>{var a;null===(a=this.formGroup.get("buyer"))||void 0===a||a.setValue(s.buyer),this.selectedBuyer=s.buyer,this.addWorkOrderToNewInvoiceItem([s])}):o?this.importInvoiceFrom("preInvoice",o):n&&this.importInvoiceFrom("advanceInvoice",n)))})}hasPrivilege(t){return this.authStoreService.isAllowed(t)}initializeCreate(){var t,o,n,r,s,a,m,d,p,f,_,g,v,h,O,b,k,A,j,U,W,Q,D;this.isEdit&&(this.selectedBuyer=this.invoice.buyer),this.formGroup=new c.cw({type:new c.NI((null===(t=this.invoice)||void 0===t?void 0:t.type)||this.typesOptions[0].value,[c.kI.required]),number:new c.NI((null===(o=this.invoice)||void 0===o?void 0:o.number)||0,[c.kI.required]),dateOfCreate:new c.NI((null===(n=this.invoice)||void 0===n?void 0:n.dateOfCreate)||(new Date).toISOString().substring(0,10),[c.kI.required]),dateOfTurnover:new c.NI((null===(r=this.invoice)||void 0===r?void 0:r.dateOfTurnover)||(new Date).toISOString().substring(0,10),[c.kI.required]),dateOfMaturity:new c.NI((null===(s=this.invoice)||void 0===s?void 0:s.dateOfMaturity)||(new Date).toISOString().substring(0,10),[c.kI.required]),placeOfIssue:new c.NI((null===(a=this.invoice)||void 0===a?void 0:a.placeOfIssue)||(null===(m=this.settings)||void 0===m?void 0:m.invoicePlaceOfIssue)||"",[c.kI.required]),methodOfPayment:new c.NI((null===(d=this.invoice)||void 0===d?void 0:d.methodOfPayment)||(null===(p=this.settings)||void 0===p?void 0:p.invoiceMethodOfPayment),[c.kI.required]),comment:new c.NI((null===(f=this.invoice)||void 0===f?void 0:f.comment)||"",[]),netAmount:new c.NI((null===(_=this.invoice)||void 0===_?void 0:_.netAmount)||0,[c.kI.required,c.kI.min(.01)]),vatRate:new c.NI((null===(g=this.invoice)||void 0===g?void 0:g.vatRate)||0,[c.kI.required]),vatAmount:new c.NI((null===(v=this.invoice)||void 0===v?void 0:v.vatAmount)||0,[c.kI.required]),grossAmount:new c.NI((null===(h=this.invoice)||void 0===h?void 0:h.grossAmount)||0,[c.kI.required,c.kI.min(.01)]),currency:new c.NI((null===(O=this.invoice)||void 0===O?void 0:O.currency)||(null===(b=this.settings)||void 0===b?void 0:b.invoiceCurrency)||"",[c.kI.required]),country:new c.NI((null===(k=this.invoice)||void 0===k?void 0:k.country)||(null===(A=this.settings)||void 0===A?void 0:A.invoiceCountry)||"",[c.kI.required]),buyer:new c.NI(this.selectedBuyer||"",[c.kI.required]),invoiceItems:new c.Oe([]),notes:new c.Oe([]),preInvoiceOid:new c.NI(null===(j=this.preInvoice)||void 0===j?void 0:j.oid),advanceInvoiceOid:new c.NI(null===(U=this.advanceInvoice)||void 0===U?void 0:U.oid),advancePayAmount:new c.NI((null===(W=this.invoice)||void 0===W?void 0:W.advancePayAmount)||(null===(Q=this.advanceInvoice)||void 0===Q?void 0:Q.grossAmount)||0)}),"CASH"===(null===(D=this.formGroup.get("type"))||void 0===D?void 0:D.value)&&this.formGroup.addControl("numberOfCashBill",new c.NI(this.invoice.numberOfCashBill||"",[c.kI.required])),this.isEdit?this.invoice.invoiceItems.forEach((ct,dt)=>this.addNewItem(ct)):this.setInvoiceNumber()}selectBuyer(t){t&&t.value&&(this.selectedBuyer=t.value)}isBuyerSelected(){var t;return!!(null===(t=this.formGroup.get("buyer"))||void 0===t?void 0:t.value)}addNewItem(t){var o;this.invoiceItemsFormArr.push(new c.cw({oid:new c.NI((null==t?void 0:t.oid)||""),description:new c.NI((null==t?void 0:t.description)||"",[c.kI.required]),uom:new c.NI((null==t?void 0:t.uom)||this.uomOptions[0].value,[c.kI.required]),quantity:new c.NI((null==t?void 0:t.quantity)||0,[c.kI.required,c.kI.min(0)]),pricePerUnit:new c.NI((null==t?void 0:t.pricePerUnit)||0,[c.kI.required,c.kI.min(0)]),netPrice:new c.NI((null==t?void 0:t.netPrice)||0,[c.kI.required,c.kI.min(0)]),vatRate:new c.NI(t?t.vatRate:(this.isInvoiceTaxFree?0:null===(o=this.settings)||void 0===o?void 0:o.invoiceVatRate)||0,[c.kI.required,c.kI.min(0)]),vatAmount:new c.NI((null==t?void 0:t.vatAmount)||0,[c.kI.required,c.kI.min(0)]),grossPrice:new c.NI((null==t?void 0:t.grossPrice)||0,[c.kI.required,c.kI.min(0)]),workOrderItems:new c.Oe([])})),setTimeout(()=>{var n;const r=null===(n=this.getDescription(this.invoiceItemsFormArr.length-1))||void 0===n?void 0:n.valueChanges.pipe((0,ue.O)(""),(0,me.U)(s=>this._filter(s||"")));this.filteredOptions.push(r)}),null==t||t.workOrderItems.forEach(n=>{this.addNewWorkOrderItemToInvoiceItem(this.invoiceItemsFormArr.length-1,[n])}),this.calculateInvoiceAmount()}_filter(t){const o=t.toLowerCase();return this.invoiceItemsOptions.filter(n=>n.toLowerCase().includes(o))}addWorkOrderToNewInvoiceItem(t){const o=[],n=this.getAllImportedWorkOrderItemOIDS();t.forEach(r=>{r.workOrderItems.forEach(s=>{var a;if(!n.includes(s.oid)){let m={oid:"",description:s.description,uom:s.uom,quantity:s.sumQuantity,pricePerUnit:0,netPrice:0,vatRate:(null===(a=this.settings)||void 0===a?void 0:a.invoiceVatRate)||20,vatAmount:0,grossPrice:0,workOrderItems:[s]};const d=o.filter(p=>p.description===m.description&&p.uom===m.uom)[0];d?(d.quantity=d.quantity+m.quantity,d.workOrderItems.push(s)):o.push(m)}}),this.addWorkOrderToComment(r)}),o.forEach(r=>{this.addNewItem(r)})}addWorkOrderToComment(t){const o=this.formGroup.get("comment");(null==o?void 0:o.value.length)&&!(null==o?void 0:o.value.includes((0,C.Nw)(t)))?o.setValue(o.value+", "+(0,C.Nw)(t)):null==o||o.setValue(this.translateService.instant("attachmentWorkOrderNumber")+" "+(0,C.Nw)(t))}addNewWorkOrderItemToInvoiceItem(t,o){o.forEach(n=>{this.getWorkOrderItemsFormArr(t).push(new c.cw({oid:new c.NI(n.oid),description:new c.NI(n.description),uom:new c.NI(n.uom),dimension1:new c.NI(n.dimension1),dimension2:new c.NI(n.dimension2),dimension3:new c.NI(n.dimension3),quantity:new c.NI(n.quantity),sumQuantity:new c.NI(n.sumQuantity),note:new c.NI(n.note)}))})}importWorkOrderItems(t){var o;this.workOrderItemSelectionComponentService.openDialog((null===(o=this.selectedBuyer)||void 0===o?void 0:o.oid)||"",this.getAllImportedWorkOrderItemOIDS()).subscribe(n=>{if(n){const r=[];n.forEach(s=>{s.workOrderItems.forEach(a=>{var m;let d={oid:"",description:a.description,uom:a.uom,quantity:a.sumQuantity,pricePerUnit:0,netPrice:0,vatRate:(null===(m=this.settings)||void 0===m?void 0:m.invoiceVatRate)||20,vatAmount:0,grossPrice:0,workOrderItems:[a]};const p=r.filter(f=>f.uom===d.uom)[0];p?(p.description=p.description.includes(a.description)?a.description:p.description+", "+a.description,p.quantity=p.quantity+d.quantity,p.workOrderItems.push(a)):r.push(d)})}),r.forEach((s,a)=>{var m,d,p,f,_,g,v,h;const O=null===(m=this.getDescription(t))||void 0===m?void 0:m.value;!O&&0===(null===(d=this.getQuantity(t))||void 0===d?void 0:d.value)||(null===(p=this.getDescription(t))||void 0===p?void 0:p.value.includes(s.description))&&(null===(f=this.getUOM(t))||void 0===f?void 0:f.value)===s.uom?(O.includes(s.description)||null===(_=this.getDescription(t))||void 0===_||_.setValue(O.length?", "+s.description:s.description),null===(g=this.getUOM(t))||void 0===g||g.setValue(s.uom),null===(v=this.getQuantity(t))||void 0===v||v.setValue((null===(h=this.getQuantity(t))||void 0===h?void 0:h.value)+s.quantity),this.addNewWorkOrderItemToInvoiceItem(t,s.workOrderItems)):this.addNewItem(s)}),n.forEach(s=>{this.addWorkOrderToComment(s)})}})}removeWorkOrderItemFromInvoiceItem(t,o){this.getWorkOrderItemsFormArr(t).removeAt(o),this.formGroup.markAsDirty()}buyerChanged(){setTimeout(()=>{var t;this.isBuyerSelected=null===(t=this.formGroup.get("buyer"))||void 0===t?void 0:t.value;for(let o=this.invoiceItemsFormArr.controls.length-1;o>=0;o--)this.invoiceItemsFormArr.controls[o].value.workOrderItems&&this.invoiceItemsFormArr.controls[o].value.workOrderItems.length&&this.invoiceItemsFormArr.removeAt(o);this.setFocusOn("dateOfCreate")})}removeItem(t){this.invoiceItemsFormArr.removeAt(t),this.calculateInvoiceAmount()}cancel(){this.router.navigate(["/"])}handleSubmitButton(){this.setAllInvoiceAmounts(),this.isEdit&&this.invoiceOID?this.webService.updateEntity(this.invoiceOID,this.formGroup.value).subscribe(t=>{t&&this.globalService.showBasicAlert(R.I.success,this.translateService.instant("successfully"),this.translateService.instant("invoiceIsSuccessfullyUpdated"))}):this.webService.createEntity(this.formGroup.value).subscribe(t=>{t&&(this.globalService.showBasicAlert(R.I.success,this.translateService.instant("successfully"),this.translateService.instant("newInvoiceIsSuccessfullyCreated")),window.open("#/print/invoice-view/"+t.oid),this.router.navigate(["invoices","edit",t.oid]))})}invoiceTypeChanged(t){setTimeout(()=>{var o,n,r,s,a,m,d,p,f,_,g,v,h,O,b,k;if(null===(o=this.formGroup.get("comment"))||void 0===o||o.setValue(""),"FOREIGN"!==t&&this.notesFormArr.controls.length)for(let A=this.notesFormArr.controls.length-1;A>=0;A--)this.removeNote(A);switch(t){case"CASH":this.formGroup.addControl("numberOfCashBill",new c.NI("",[c.kI.required])),null===(n=this.formGroup.get("currency"))||void 0===n||n.setValue(null===(r=this.settings)||void 0===r?void 0:r.invoiceCurrency),setTimeout(()=>{this.setFocusOn("numberOfCashBill")}),null===(s=this.formGroup.get("methodOfPayment"))||void 0===s||s.setValue(null===(a=this.settings)||void 0===a?void 0:a.invoiceMethodOfPaymentForCashBill);break;case"FOREIGN":null===(m=this.formGroup.get("currency"))||void 0===m||m.setValue("EUR"),null===(d=this.formGroup.get("comment"))||void 0===d||d.setValue(null===(p=this.settings)||void 0===p?void 0:p.invoiceForeignNote),null===(_=null===(f=this.settings)||void 0===f?void 0:f.invoiceForeignNotes)||void 0===_||_.forEach(A=>{this.addNote({oid:"",name:A.key,description:A.value})}),null===(g=this.formGroup.get("methodOfPayment"))||void 0===g||g.setValue(null===(v=this.settings)||void 0===v?void 0:v.invoiceMethodOfPayment);break;default:this.formGroup.removeControl("numberOfCashBill"),null===(h=this.formGroup.get("currency"))||void 0===h||h.setValue(null===(O=this.settings)||void 0===O?void 0:O.invoiceCurrency),this.setFocusOn("currency"),null===(b=this.formGroup.get("methodOfPayment"))||void 0===b||b.setValue(null===(k=this.settings)||void 0===k?void 0:k.invoiceMethodOfPayment)}this.isEdit||this.setInvoiceNumber()})}setInvoiceNumber(){var t,o;this.webService.getNextInvoiceNumber(null===(t=this.formGroup.get("type"))||void 0===t?void 0:t.value,null===(o=this.formGroup.get("dateOfCreate"))||void 0===o?void 0:o.value).subscribe(n=>{var r,s;null===(r=this.formGroup.get("number"))||void 0===r||r.setValue(n+"/"+new Date(null===(s=this.formGroup.get("dateOfCreate"))||void 0===s?void 0:s.value).getFullYear().toString())})}createBuyer(){this.buyerCreateEditPopupService.openDialog().subscribe(t=>{t&&this.listEntities.requestFirstPage()})}changeIsInvoiceTaxFree(){var t,o,n,r;const s=this.formGroup.get("comment"),a=(null==s?void 0:s.value)||"";this.isInvoiceTaxFree?(this.invoiceItemsFormArr.controls.forEach((m,d)=>{var p;null===(p=m.get("vatRate"))||void 0===p||p.setValue(0),this.calculateInvoiceItemAmount(d,"vatRate")}),(null===(t=this.settings)||void 0===t?void 0:t.invoiceTaxFreeText)&&a.includes(null===(o=this.settings)||void 0===o?void 0:o.invoiceTaxFreeText)||null==s||s.setValue(a+(a.length>0?", ":"")+(null===(n=this.settings)||void 0===n?void 0:n.invoiceTaxFreeText))):(this.invoiceItemsFormArr.controls.forEach((m,d)=>{var p,f;null===(p=m.get("vatRate"))||void 0===p||p.setValue(null===(f=this.settings)||void 0===f?void 0:f.invoiceVatRate),this.calculateInvoiceItemAmount(d,"vatRate")}),(null===(r=this.settings)||void 0===r?void 0:r.invoiceTaxFreeText)&&a.includes(this.settings.invoiceTaxFreeText)&&(null==s||s.setValue(a.replace(this.settings.invoiceTaxFreeText,""))))}calculateInvoiceItemAmount(t,o){let n=this.invoiceItemsFormArr.controls[t].get("quantity"),r=1*(null==n?void 0:n.value),s=this.invoiceItemsFormArr.controls[t].get("pricePerUnit"),a=1*(null==s?void 0:s.value),m=this.invoiceItemsFormArr.controls[t].get("netPrice"),d=1*(null==m?void 0:m.value),p=this.invoiceItemsFormArr.controls[t].get("vatRate"),f=1*(null==p?void 0:p.value),_=this.invoiceItemsFormArr.controls[t].get("vatAmount"),g=1*(null==_?void 0:_.value),v=this.invoiceItemsFormArr.controls[t].get("grossPrice"),h=1*(null==v?void 0:v.value);switch(o){case"quantity":case"pricePerUnit":d=r*a,null==m||m.setValue(d),g=d*f/100,null==_||_.setValue(g),null==v||v.setValue(d+g);break;case"netPrice":r<=0&&(r=1,null==n||n.setValue(r)),a=d/r,null==s||s.setValue(a),g=d*f/100,null==_||_.setValue(g),null==v||v.setValue(d+g);break;case"vatRate":g=d*f/100,null==_||_.setValue(g),null==v||v.setValue(d+g);break;case"vatAmount":d=100*g/f,null==m||m.setValue(d),r<=0&&(r=1,null==n||n.setValue(r)),a=d/r,null==s||s.setValue(a),null==v||v.setValue(d+g);break;case"grossPrice":g=h*f/(100+f),null==_||_.setValue(g),d=h-g,null==m||m.setValue(d),r<=0&&(r=1,null==n||n.setValue(r)),a=d/r,null==s||s.setValue(a)}this.calculateInvoiceAmount()}calculateInvoiceAmount(){setTimeout(()=>{var t,o,n,r;let s=0,a=0,m=0,d=0;this.invoiceItemsFormArr.value.forEach(p=>{s+=p.netPrice,a+=p.vatRate,m+=p.vatAmount,d+=p.grossPrice}),null===(t=this.formGroup.get("netAmount"))||void 0===t||t.setValue((0,C.wz)(s)),null===(o=this.formGroup.get("vatRate"))||void 0===o||o.setValue((0,C.wz)(a/this.invoiceItemsFormArr.length)),null===(n=this.formGroup.get("vatAmount"))||void 0===n||n.setValue((0,C.wz)(m)),null===(r=this.formGroup.get("grossAmount"))||void 0===r||r.setValue((0,C.wz)(d))})}setAllInvoiceAmounts(){this.invoiceItemsFormArr.controls.forEach(t=>{var o,n,r,s,a,m;const d=1*(null===(o=t.get("grossPrice"))||void 0===o?void 0:o.value),p=1*(null===(n=t.get("vatAmount"))||void 0===n?void 0:n.value),f=1*(null===(r=t.get("vatRate"))||void 0===r?void 0:r.value);null===(s=t.get("grossPrice"))||void 0===s||s.setValue((0,C.wz)(d)),null===(a=t.get("vatAmount"))||void 0===a||a.setValue((0,C.wz)(d*f/(100+f))),null===(m=t.get("netPrice"))||void 0===m||m.setValue((0,C.wz)(d-p))}),this.calculateInvoiceAmount()}autoImport(){var t;this.workOrderSelectionComponentService.openDialog((null===(t=this.selectedBuyer)||void 0===t?void 0:t.oid)||"",[]).subscribe(n=>{n&&this.addWorkOrderToNewInvoiceItem(n)})}getAllImportedWorkOrderItemOIDS(){const t=[];return this.invoiceItemsFormArr.controls.forEach((o,n)=>{this.getWorkOrderItemsFormArr(n).controls.forEach(r=>{t.push(r.value.oid)})}),t}searchHandler(t){let o=new de.h;o.criteriaQuick=t,this.listEntities.setFilter(o)}importInvoiceFrom(t,o){this.webService.getEntityByOid(o).subscribe(n=>{var r,s;"advanceInvoice"===t?this.advanceInvoice=n:this.preInvoice=n,this.selectedBuyer=n.buyer,this.initializeCreate(),null===(r=this.formGroup.get("comment"))||void 0===r||r.setValue((null===(s=this.formGroup.get("comment"))||void 0===s?void 0:s.value)+this.translateService.instant("advanceInvoice"===t?"invoiceCreatedOnAdvanceInvoice":"invoiceCreatedOnPreInvoice",{invoiceNumber:n.number,invoiceDate:new Date(n.dateOfCreate).getDay()+"/"+new Date(n.dateOfCreate).getMonth()+"/"+new Date(n.dateOfCreate).getFullYear()})),n.invoiceItems.forEach((a,m)=>{a.oid="",a.workOrderItems=[],this.addNewItem(a)}),this.formGroup.markAsDirty()})}bottomReachedHandlerBuyers(){this.listEntities.requestNextPage()}consolidateAllDates(){var t,o,n,r;null===(t=this.formGroup.get("dateOfTurnover"))||void 0===t||t.setValue(null===(o=this.formGroup.get("dateOfCreate"))||void 0===o?void 0:o.value),null===(n=this.formGroup.get("dateOfMaturity"))||void 0===n||n.setValue(null===(r=this.formGroup.get("dateOfCreate"))||void 0===r?void 0:r.value)}onKeypress(t,o,n=-1){if("Enter"===t.key)switch(t.preventDefault(),o){case"numberOfCashBill":this.setFocusOn("currency");break;case"currency":this.setFocusOn("number");break;case"number":this.setFocusOn("buyer");break;case"dateOfCreate":this.setFocusOn("dateOfTurnover");break;case"dateOfTurnover":this.setFocusOn("dateOfMaturity");break;case"dateOfMaturity":this.setFocusOn("country");break;case"country":this.setFocusOn("placeOfIssue");break;case"placeOfIssue":this.setFocusOn("methodOfPayment");break;case"methodOfPayment":this.setFocusOn("description",0,!0);break;case"description":this.setFocusOn("uom",n);break;case"uom":this.setFocusOn("quantity",n,!0);break;case"quantity":this.setFocusOn("pricePerUnit",n,!0);break;case"pricePerUnit":this.setFocusOn("netPrice",n,!0);break;case"netPrice":this.setFocusOn("vatRate",n,!0);break;case"vatRate":this.setFocusOn("vatAmount",n,!0);break;case"vatAmount":this.setFocusOn("grossPrice",n,!0);break;case"grossPrice":this.invoiceItemsFormArr.length===n+1&&this.addNewItem(),setTimeout(()=>{this.setFocusOn("description",n+1)})}}setFocusOn(t,o=0,n=!1){const r=this.el.nativeElement.querySelectorAll('[formcontrolname="'+t+'"]')[o<0?0:o];null==r||r.focus(),n&&r.select()}openedToggleOnUomSelect(t,o){var n,r;!t&&(null===(n=this.getUOM(o))||void 0===n?void 0:n.value)&&this.uomChanged(null===(r=this.getUOM(o))||void 0===r?void 0:r.value,o)}uomChanged(t,o){setTimeout(()=>{this.setFocusOn("quantity",o,!0)})}getFilteredOptions(t){return this.filteredOptions[t]}addNote(t){this.notesFormArr.push(new c.cw({oid:new c.NI((null==t?void 0:t.oid)||""),name:new c.NI((null==t?void 0:t.name)||"",[c.kI.required]),description:new c.NI((null==t?void 0:t.description)||"",[c.kI.required])}))}removeNote(t){this.notesFormArr.removeAt(t)}ngOnDestroy(){this.subs.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(q.F0),e.Y36(q.gz),e.Y36(Ze.U),e.Y36(Y.b),e.Y36(M.o),e.Y36(V.e),e.Y36(B.X),e.Y36(be.G),e.Y36(y.sK),e.Y36(T.y),e.Y36(e.SBq),e.Y36(ee),e.Y36(te),e.Y36(ke.g))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-invoice-create-edit"]],features:[e._Bn([Y.b,B.X,V.e,le.u,T.y,M.o,ee,te])],decls:10,vars:7,consts:[[1,"wrapper"],[1,"container"],[1,"title"],[4,"ngIf"],["class","form",3,"formGroup",4,"ngIf"],["class","button-section",4,"ngIf"],[1,"form",3,"formGroup"],[1,"row"],["formControlName","type",3,"disabled","valueChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","formControlName","currency",3,"keypress"],["type","text","matInput","","formControlName","number",3,"keypress"],[1,"bottom-padding",3,"isTransparentMode","text","clickEvent"],["formControlName","buyer","msInfiniteScroll","",3,"disabled","compareWith","valueChange","infiniteScroll","selectionChange"],[3,"formControl","placeholderLabel","noEntriesFoundLabel","hideClearSearchButton","clearSearchInput","searching","disableScrollToActiveOnOptionsChanged","ngModelChange"],[3,"value",4,"ngIf"],[4,"ngFor","ngForOf"],["class","create-buyer-button",3,"iconName","disabled","clickEvent",4,"ngIf"],[1,"create-buyer-button",3,"color","ngModel","ngModelOptions","ngModelChange","change"],["type","date","matInput","","formControlName","dateOfCreate",3,"change","keypress"],["type","date","matInput","","formControlName","dateOfTurnover",3,"keypress"],["type","date","matInput","","formControlName","dateOfMaturity",3,"keypress"],["type","text","matInput","","formControlName","country",3,"keypress"],["type","text","matInput","","formControlName","placeOfIssue",3,"keypress"],["type","text","matInput","","formControlName","methodOfPayment",3,"keypress"],["formArrayName","invoiceItems","class","invoice-items",4,"ngIf"],[1,"buttons"],[1,"big-button",3,"iconName","text","disabled","clickEvent"],[1,"big-button",3,"iconName","text","isTransparentMode","disabled","clickEvent"],["matInput","","formControlName","comment","rows","3",3,"keypress"],["type","text","appDecimal","","matInput","","formControlName","netAmount",3,"readonly"],["type","text","appDecimal","","matInput","","formControlName","vatRate",3,"readonly"],["type","text","appDecimal","","matInput","","formControlName","vatAmount",3,"readonly"],["type","text","appDecimal","","matInput","","formControlName","grossAmount",3,"readonly"],["class","notes","formArrayName","notes",4,"ngIf"],[3,"value"],["type","text","matInput","","formControlName","numberOfCashBill",3,"keypress"],[1,"create-buyer-button",3,"iconName","disabled","clickEvent"],["formArrayName","invoiceItems",1,"invoice-items"],["class","invoice-item",4,"ngFor","ngForOf"],[1,"invoice-item"],[1,"form-group",3,"formGroupName"],[1,"full-width"],["type","text","matInput","","formControlName","description",3,"matAutocomplete","keydown.enter","keypress"],["trigger","matAutocompleteTrigger"],["auto","matAutocomplete"],[1,"number-field"],["formControlName","uom",3,"openedChange"],["type","text","appDecimal","","matInput","","formControlName","quantity",3,"keypress","change","focusout"],["type","text","appDecimal","","matInput","","formControlName","pricePerUnit",3,"keypress","change","focusout"],["type","text","appDecimal","","matInput","","formControlName","netPrice",3,"keypress","change","focusout"],["type","text","appDecimal","","matInput","","formControlName","vatRate",3,"keypress","change","focusout"],["type","text","appDecimal","","matInput","","formControlName","vatAmount",3,"keypress","change","focusout"],["type","text","appDecimal","","matInput","","formControlName","grossPrice",3,"keypress","change","focusout"],[1,"additional-button",3,"text","clickEvent"],[1,"additional-button",3,"iconName","isTransparentMode","clickEvent"],["formArrayName","workOrderItems","multiple","",3,"value"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["type","text","appDecimal","","matInput","","formControlName","advancePayAmount"],["formArrayName","notes",1,"notes"],["class","row",4,"ngFor","ngForOf"],[3,"text","clickEvent"],["type","text","matInput","","formControlName","name"],["type","text","matInput","","formControlName","description"],[1,"button-section"],["color","secondary",1,"cancel",3,"text","clickEvent"],[1,"update",3,"text","disabled","clickEvent"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"h3"),e._uU(4),e.ALo(5,"translate"),e.YNc(6,Pe,3,4,"span",3),e.YNc(7,we,3,4,"span",3),e.qZA(),e.qZA(),e.YNc(8,Ye,105,158,"form",4),e.qZA(),e.YNc(9,Ge,5,7,"div",5),e.qZA()),2&t&&(e.xp6(4),e.hij(" ",e.lcZ(5,5,o.isEdit?"editInvoice":"createInvoice")," "),e.xp6(2),e.Q6J("ngIf",o.preInvoice),e.xp6(1),e.Q6J("ngIf",o.advanceInvoice),e.xp6(1),e.Q6J("ngIf",o.formGroup),e.xp6(1),e.Q6J("ngIf",o.formGroup))},directives:[x.O5,c._Y,c.JL,c.sg,w.KE,w.hX,E.gD,c.JJ,c.u,x.sg,oe.Nt,c.Fj,S.r,ne.s,Te.ey,ie.nu,c.oH,Z.oG,c.On,Me.U,c.CE,c.x0,F.ZL,F.XC],pipes:[y.X$,x.Ov],styles:[".wrapper[_ngcontent-%COMP%]{height:calc(100%)}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{width:100%;height:calc(100% - 100px);overflow-y:auto}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;border-bottom:2px dotted var(--color-main-light)}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{flex-direction:column;margin-top:20px;display:flex;width:100%}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .create-buyer-button[_ngcontent-%COMP%]{margin:10px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .import-buttons[_ngcontent-%COMP%]{display:flex;margin:10px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .import-buttons[_ngcontent-%COMP%]   app-button[_ngcontent-%COMP%]{margin-right:20px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .bottom-padding[_ngcontent-%COMP%]{display:flex;align-items:center;padding-bottom:1.34375em;margin-left:20px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .invoice-items[_ngcontent-%COMP%]   .invoice-item[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .invoice-items[_ngcontent-%COMP%]   .invoice-item[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{flex-grow:1}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .invoice-items[_ngcontent-%COMP%]   .invoice-item[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .number-field[_ngcontent-%COMP%]{flex-shrink:1;max-width:100px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;align-items:center}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .big-button[_ngcontent-%COMP%]{margin-right:20px}.wrapper[_ngcontent-%COMP%]   .button-section[_ngcontent-%COMP%]{display:flex;width:100%;height:60px;flex-direction:row;align-items:center;justify-content:space-between}.additional-button[_ngcontent-%COMP%]{margin:10px 5px}"]}),i})(),canActivate:[ae.Y],data:{permission:"INVOICE_CREATE"}}];let ze=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[q.Bz.forChild($e)],q.Bz]}),i})();var J=u(2024),Ke=u(7707),Xe=u(6688),L=u(7942),et=u(5245),tt=u(9139),ot=u(7012),re=u(6460),se=u(8109),ce=u(8287);let nt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[x.ez,L.p,Z.p9,y.aw]]}),i})(),it=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[x.ez,I.Is,J.h,y.aw,re.n,w.lN,E.LD,se.V,ce.n,nt]]}),i})(),rt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[x.ez,I.Is,J.h,y.aw,re.n,w.lN,E.LD,se.V,ce.n,L.p,Z.p9,c.u5]]}),i})(),st=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[x.ez,ze,y.aw,J.h,Ke.R,c.UX,oe.c,w.lN,E.LD,tt._,Xe.Hi,L.p,et.Ps,ie.Co,ne.I,ot.o,F.Bb,Z.p9,it,rt,Z.p9,c.u5]]}),i})()}}]);