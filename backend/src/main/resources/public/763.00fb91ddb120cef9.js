"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[763],{8763:(W,v,o)=>{o.d(v,{X:()=>Y});var c=o(5412),x=o(6498),i=o(4006),u=o(4794),y=o(4463),p=o(7379),d=o(136),f=o(4068),h=o(6789),C=o(5595),b=o(287),Z=o(2134),A=o(13),t=o(4650),E=o(8794),g=o(8490),T=o(8933),m=o(6895),k=o(42),_=o(9549),N=o(4144),q=o(4385),I=o(3238),j=o(4603),w=o(3231);function S(r,l){if(1&r&&(t.TgZ(0,"mat-option",20),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&r){const e=l.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.displayName)," ")}}function O(r,l){if(1&r&&(t.TgZ(0,"mat-option",20),t._uU(1),t.qZA()),2&r){const e=t.oxw(3);t.Q6J("value",e.selectedCity),t.xp6(1),t.Oqu(e.selectedCity.name)}}function B(r,l){if(1&r&&(t.TgZ(0,"mat-option",20),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.name," ")}}function L(r,l){if(1&r&&(t.ynx(0),t.YNc(1,B,2,2,"mat-option",23),t.BQk()),2&r){const e=l.$implicit,n=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(null==n.selectedCity?null:n.selectedCity.oid)!==e.oid)}}function P(r,l){if(1&r){const e=t.EpF();t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-select",21),t.NdJ("infiniteScroll",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.bottomReachedHandler())})("selectionChange",function(a){t.CHM(e);const s=t.oxw(2);return t.KtG(s.selectCity(a))}),t.TgZ(5,"mat-option"),t._UZ(6,"ngx-mat-select-search",22),t.ALo(7,"translate"),t.ALo(8,"translate"),t.ALo(9,"async"),t.qZA(),t.YNc(10,O,2,2,"mat-option",23),t.YNc(11,L,2,1,"ng-container",24),t.ALo(12,"async"),t.qZA()()}if(2&r){const e=t.oxw(2);t.xp6(1),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(3,15,"city")," "),t.xp6(2),t.Q6J("compareWith",e.compareFn),t.xp6(2),t.s9C("placeholderLabel",t.lcZ(7,17,"searchFor")),t.s9C("noEntriesFoundLabel",t.lcZ(8,19,"noResults")),t.Q6J("formControl",e.searchControlCity)("hideClearSearchButton",!0)("clearSearchInput",!1)("searching",t.lcZ(9,21,e.isLoading)||!1)("disableScrollToActiveOnOptionsChanged",!0),t.xp6(4),t.Q6J("ngIf",e.selectedCity),t.xp6(1),t.Q6J("ngForOf",t.lcZ(12,23,e.cities))}}function U(r,l){1&r&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"input",25),t.qZA()),2&r&&(t.xp6(1),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(3,5,"maticalNumber")," "))}function J(r,l){1&r&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"input",26),t.qZA()),2&r&&(t.xp6(1),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(3,5,"pib")," "))}function G(r,l){if(1&r&&(t.TgZ(0,"mat-option",20),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&r){const e=l.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.displayName)," ")}}function F(r,l){if(1&r&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-select",27),t.YNc(5,G,3,4,"mat-option",6),t.qZA()()),2&r){const e=t.oxw(2);t.xp6(1),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(3,6,"gender")," "),t.xp6(3),t.Q6J("ngForOf",e.genderTypesOptions)}}function M(r,l){if(1&r){const e=t.EpF();t.TgZ(0,"form",3)(1,"div",4)(2,"mat-form-field")(3,"mat-label"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"mat-select",5),t.NdJ("valueChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.typeChangeHandler(a))}),t.YNc(7,S,3,4,"mat-option",6),t.qZA()()(),t.TgZ(8,"div",4)(9,"mat-form-field")(10,"mat-label"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t._UZ(13,"input",7),t.qZA()(),t.TgZ(14,"div",4)(15,"mat-form-field")(16,"mat-label"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t._UZ(19,"input",8),t.qZA(),t.YNc(20,P,13,25,"mat-form-field",9),t.TgZ(21,"app-button",10),t.NdJ("clickEvent",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.createCity())}),t.ALo(22,"translate"),t.qZA()(),t.TgZ(23,"div",4),t.YNc(24,U,5,7,"mat-form-field",9),t.YNc(25,J,5,7,"mat-form-field",9),t.qZA(),t._uU(26),t.ALo(27,"translate"),t.TgZ(28,"div",4)(29,"mat-form-field")(30,"mat-label"),t._uU(31),t.ALo(32,"translate"),t.qZA(),t._UZ(33,"input",11),t.qZA()(),t.TgZ(34,"div",4)(35,"mat-form-field")(36,"mat-label"),t._uU(37),t.ALo(38,"translate"),t.qZA(),t._UZ(39,"input",12),t.qZA(),t.TgZ(40,"mat-form-field")(41,"mat-label"),t._uU(42),t.ALo(43,"translate"),t.qZA(),t._UZ(44,"input",13),t.qZA(),t.TgZ(45,"mat-form-field")(46,"mat-label"),t._uU(47),t.ALo(48,"translate"),t.qZA(),t._UZ(49,"input",14),t.qZA()(),t.TgZ(50,"div",4)(51,"mat-form-field")(52,"mat-label"),t._uU(53),t.ALo(54,"translate"),t.qZA(),t._UZ(55,"input",15),t.qZA(),t.TgZ(56,"mat-form-field")(57,"mat-label"),t._uU(58),t.ALo(59,"translate"),t.qZA(),t._UZ(60,"input",16),t.qZA(),t.YNc(61,F,6,8,"mat-form-field",9),t.qZA(),t.TgZ(62,"div",17)(63,"app-button",18),t.NdJ("clickEvent",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.cancel())}),t.ALo(64,"translate"),t.qZA(),t.TgZ(65,"app-button",19),t.NdJ("clickEvent",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleSubmitButton())}),t.ALo(66,"translate"),t.qZA()()()}if(2&r){const e=t.oxw();t.Q6J("formGroup",e.formGroup),t.xp6(3),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(5,60,"type")," "),t.xp6(2),t.Q6J("disabled",e.isEdit),t.xp6(1),t.Q6J("ngForOf",e.buyerTypesOptions),t.xp6(3),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(12,62,"name")," "),t.xp6(5),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(18,64,"address")," "),t.xp6(3),t.Q6J("ngIf",e.cityControl),t.xp6(1),t.Q6J("text",t.lcZ(22,66,"createCity"))("iconName","plus")("color","secondary")("disabled",!e.hasPrivilege("CITY_CREATE")),t.xp6(3),t.Q6J("ngIf",e.maticalNumberControl),t.xp6(1),t.Q6J("ngIf",e.pibControl),t.xp6(1),t.hij(" ",t.lcZ(27,68,"optionalData")," "),t.xp6(4),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(32,70,"account")," "),t.xp6(5),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(38,72,"email")," "),t.xp6(4),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(43,74,"jbkjs")," "),t.xp6(4),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(48,76,"contactPerson")," "),t.xp6(5),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(54,78,"phoneNumberMobile")," "),t.xp6(4),t.ekj("mark-required",!0)("mark-opt-required",!0),t.xp6(1),t.hij(" ",t.lcZ(59,80,"phoneNumberFix")," "),t.xp6(3),t.Q6J("ngIf",e.genderControl),t.xp6(2),t.Q6J("text",t.lcZ(64,82,"cancel")),t.xp6(2),t.Q6J("text",t.lcZ(66,84,"save"))("disabled",e.isEdit&&!e.formGroup.dirty||e.formGroup.invalid)}}let Q=(()=>{class r{constructor(e,n,a,s,H,D,R,K,$){this.dialogRef=e,this.data=n,this.globalService=a,this.cityWebService=s,this.webService=H,this.cityCreateEditPopupService=D,this.translateService=R,this.listEntities=K,this.authStoreService=$,this.subs=new y.L,this.isEdit=!1,this.buyerTypesOptions=d.kp,this.genderTypesOptions=d.ps,this.cities=this.listEntities.entities,this.isLoading=this.listEntities.isLoading,this.searchControlCity=new i.p4,this.compareFn=Z.nt,this.debounceTime=500}get genderControl(){return this.formGroup.get("gender")}get pibControl(){return this.formGroup.get("pib")}get maticalNumberControl(){return this.formGroup.get("maticalNumber")}get cityControl(){return this.formGroup.get("city")}ngOnInit(){this.isEdit=!!this.data.oid,this.buyerOID=this.data.oid,this.subs.sink=this.listEntities.setWebService(this.cityWebService).requestFirstPage(),this.isEdit?this.initializeEdit():this.initializeCreate(),this.inputSearchControlCitySubscription=this.searchControlCity.valueChanges.pipe((0,A.b)(this.debounceTime)).subscribe(()=>{this.searchHandler(this.searchControlCity.value)})}hasPrivilege(e){return this.authStoreService.isAllowed(e)}initializeCreate(){this.formGroup=new i.nJ({type:new i.p4(this.buyerTypesOptions[0].value,[i.kI.required]),name:new i.p4("",[i.kI.required]),address:new i.p4("",[i.kI.required]),addressContact:new i.p4("",[]),contactPerson:new i.p4("",[]),phoneNumberFix:new i.p4("",[]),phoneNumberMobile:new i.p4("",[]),email:new i.p4("",[i.kI.email]),city:new i.p4("",[i.kI.required]),jbkjs:new i.p4("",[]),account:new i.p4("",[])}),this.typeChangeHandler(this.formGroup.get("type")?.value)}initializeEdit(){this.subs.sink=this.webService.getEntityByOid(this.buyerOID).subscribe(e=>{e&&(this.formGroup=new i.nJ({type:new i.p4(e.type,[i.kI.required]),name:new i.p4(e.name,[i.kI.required]),address:new i.p4(e.address,[i.kI.required]),contactPerson:new i.p4(e.contactPerson,[]),phoneNumberFix:new i.p4(e.phoneNumberFix,[]),phoneNumberMobile:new i.p4(e.phoneNumberMobile,[]),email:new i.p4(e.email,[i.kI.email]),city:new i.p4(e.city,[i.kI.required]),jbkjs:new i.p4(e.jbkjs,[]),account:new i.p4(e.account,[])}),this.selectedCity=e.city,this.typeChangeHandler(this.formGroup.get("type")?.value,e.maticalNumber,e.pib,e.gender))})}selectCity(e){e&&e.value&&(this.selectedCity=e.value)}cancel(){this.dialogRef.close(!1)}handleSubmitButton(){const e=this.formGroup.value;""===e.gender&&(e.gender=null),this.isEdit?this.subs.sink.updateEntity$=this.webService.updateEntity(this.buyerOID,e).subscribe(n=>{n&&(this.globalService.showBasicAlert(u.I.success,this.translateService.instant("successfully"),this.translateService.instant("buyerIsSuccessfullyUpdated")),this.dialogRef.close(n))}):this.subs.sink.createEntity$=this.webService.createEntity(e).subscribe(n=>{n&&(this.globalService.showBasicAlert(u.I.success,this.translateService.instant("successfully"),this.translateService.instant("newBuyerIsSuccessfullyCreated")),this.dialogRef.close(n))})}typeChangeHandler(e,n="",a="",s=""){switch(e){case"COMPANY":this.formGroup.addControl("maticalNumber",new i.p4(n,[i.kI.required])),this.formGroup.addControl("pib",new i.p4(a,[i.kI.required])),this.formGroup.removeControl("gender");break;case"PERSON":this.formGroup.addControl("gender",new i.p4(s,[])),this.formGroup.removeControl("maticalNumber"),this.formGroup.removeControl("pib")}}createCity(){this.cityCreateEditPopupService.openDialog().subscribe(e=>{e&&this.listEntities.requestFirstPage()})}bottomReachedHandler(){this.listEntities.requestNextPage()}searchHandler(e){let n=new b.h;n.criteriaQuick=e,this.listEntities.setFilter(n)}ngOnDestroy(){this.inputSearchControlCitySubscription.unsubscribe(),this.subs.unsubscribe()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(c.so),t.Y36(c.WI),t.Y36(E.U),t.Y36(f.D),t.Y36(p.e),t.Y36(h.r),t.Y36(g.sK),t.Y36(C.y),t.Y36(T.g))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-buyer-create-edit"]],inputs:{debounceTime:"debounceTime"},features:[t._Bn([p.e,f.D,h.r,C.y])],decls:6,vars:4,consts:[[1,"container"],[1,"title"],["class","form",3,"formGroup",4,"ngIf"],[1,"form",3,"formGroup"],[1,"row"],["formControlName","type",3,"disabled","valueChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","name"],["matInput","","formControlName","address"],[4,"ngIf"],[1,"create-button",3,"text","iconName","color","disabled","clickEvent"],["matInput","","formControlName","account"],["matInput","","formControlName","email"],["matInput","","formControlName","jbkjs"],["matInput","","formControlName","contactPerson"],["matInput","","formControlName","phoneNumberMobile"],["matInput","","formControlName","phoneNumberFix"],[1,"button-section"],["color","secondary",1,"cancel",3,"text","clickEvent"],[1,"update",3,"text","disabled","clickEvent"],[3,"value"],["formControlName","city","msInfiniteScroll","",3,"compareWith","infiniteScroll","selectionChange"],[3,"formControl","placeholderLabel","noEntriesFoundLabel","hideClearSearchButton","clearSearchInput","searching","disableScrollToActiveOnOptionsChanged"],[3,"value",4,"ngIf"],[4,"ngFor","ngForOf"],["matInput","","formControlName","maticalNumber"],["matInput","","formControlName","pib"],["formControlName","gender"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,M,67,86,"form",2),t.qZA()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,2,n.isEdit?"editBuyer":"createBuyer")," "),t.xp6(2),t.Q6J("ngIf",n.formGroup))},dependencies:[m.sg,m.O5,k.r,i._Y,i.Fj,i.JJ,i.JL,i.oH,i.sg,i.u,_.KE,_.hX,N.Nt,q.gD,I.ey,j.s,w.nu,m.Ov,g.X$],styles:[".container[_ngcontent-%COMP%]{height:100%;width:100%}.container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;border-bottom:2px dotted var(--color-main-light)}.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:20px;color:var(--color-black)}.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex}.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .button-section[_ngcontent-%COMP%]{display:flex;width:100%;height:100px;flex-direction:row;align-items:center;justify-content:space-between;border-top:2px dotted var(--color-main-light)}"]}),r})(),Y=(()=>{class r{constructor(e){this._matDialog=e}openDialog(e=""){return new x.y(n=>{const a=new c.vA;a.data={oid:e},this._matDialog.open(Q,a).afterClosed().subscribe(s=>{n.next(s),n.complete()},()=>n.error())})}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(c.uw))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac}),r})()}}]);